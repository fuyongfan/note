<!DOCTYPE html><html><head><title>js 实现链式调用原理</title><meta charset='utf-8'><link href='https://dn-maxiang.qbox.me/res-min/themes/marxico.css' rel='stylesheet'><style></style></head><body><div id='preview-contents' class='note-content'>
                        
                    



<h3 id="js-实现链式调用原理">js 实现链式调用原理</h3>



<h4 id="return-this-返回当前调用函数对象">return this, 返回当前调用函数对象</h4>

<blockquote>
  <p>demo1</p>
</blockquote>



<pre class="prettyprint hljs-dark"><code class="hljs actionscript"><div class="hljs-line"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ClassA</span><span class="hljs-params">()</span></span>{
</div><div class="hljs-line">    <span class="hljs-keyword">this</span>.prop1 = <span class="hljs-literal">null</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">this</span>.prop2 = <span class="hljs-literal">null</span>;
</div><div class="hljs-line">    <span class="hljs-keyword">this</span>.prop3 = <span class="hljs-literal">null</span>;
</div><div class="hljs-line">}
</div><div class="hljs-line">ClassA.prototype = {
</div><div class="hljs-line">    method1 : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(p1)</span></span>{
</div><div class="hljs-line">        <span class="hljs-keyword">this</span>.prop1 = p1;
</div><div class="hljs-line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
</div><div class="hljs-line">    },
</div><div class="hljs-line">    method2 : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(p2)</span></span>{
</div><div class="hljs-line">        <span class="hljs-keyword">this</span>.prop2 = p2;
</div><div class="hljs-line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
</div><div class="hljs-line">    },
</div><div class="hljs-line">    method3 : <span class="hljs-function"><span class="hljs-keyword">function</span><span class="hljs-params">(p3)</span></span>{
</div><div class="hljs-line">        <span class="hljs-keyword">this</span>.prop3 = p3;
</div><div class="hljs-line">        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
</div><div class="hljs-line">    }
</div><div class="hljs-line">};
</div><div class="hljs-line"><span class="hljs-keyword">var</span> obj = <span class="hljs-keyword">new</span> ClassA();
</div><div class="hljs-line"><wbr>
</div><div class="hljs-line">obj.method1(<span class="hljs-number">1</span>).method2(<span class="hljs-number">2</span>).method3(<span class="hljs-number">3</span>);
</div></code></pre>

<ul><li>step1. 返回 实例 ： obj {prop1: 1}</li>
<li>step2. step1的结果（obj { prop1:  1 }）调用method2 返回 obj{prop1: 1, prop2: 2}</li>
<li>stop3. step2的结果（obj { prop1:  1,  prop2:  2 }）调用 method3 返回 obj { prop1:  1, prop2:  2,  prop3:  3 }</li>
</ul>

<blockquote>
  <p>demo2 : (1).plus(2).plus(3).minus(4)</p>
</blockquote>



<pre class="prettyprint hljs-dark"><code class="hljs javascript"><div class="hljs-line"><span class="hljs-built_in">Number</span>.prototype.plus = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> + val;
</div><div class="hljs-line">};
</div><div class="hljs-line"><span class="hljs-built_in">Number</span>.prototype.minus = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">val</span>) </span>{
</div><div class="hljs-line">    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span> - val;
</div><div class="hljs-line">};
</div><div class="hljs-line"><span class="hljs-keyword">var</span> res = (<span class="hljs-number">1</span>).plus(<span class="hljs-number">2</span>).plus(<span class="hljs-number">3</span>).minus(<span class="hljs-number">4</span>);
</div><div class="hljs-line"><span class="hljs-built_in">console</span>.log(res); <span class="hljs-comment">// 2;</span>
</div></code></pre></div></body></html>